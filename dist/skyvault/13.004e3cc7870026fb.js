"use strict";(self.webpackChunkskyvault=self.webpackChunkskyvault||[]).push([[13],{9013:(H,Z,l)=>{l.r(Z),l.d(Z,{DepositModule:()=>Y});var v=l(6019),_=l(4708),m=l(4762),f=l(5043),e=l(3556),A=l(3755),D=l(4071),k=l(5894),w=l(8329),x=l(847),T=l(3213);function y(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"ngx-dropzone-image-preview",22),e.NdJ("removed",function(){const n=e.CHM(t).$implicit;return e.oxw(2).onRemove(n)}),e.TgZ(1,"ngx-dropzone-label"),e._uU(2),e.qZA(),e.qZA()}if(2&o){const t=r.$implicit;e.Q6J("file",t)("removable",!0),e.xp6(2),e.AsE(" ",t.name," (",t.type,")")}}function M(o,r){if(1&o&&(e.TgZ(0,"div",23),e.TgZ(1,"span"),e._UZ(2,"fa-icon",24),e._uU(3," This transacton will not be recorded. You can record this transaction by changing the setting in Statements"),e.qZA(),e.qZA()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("icon",t.faInfoCircle)}}function b(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",5),e.TgZ(2,"h2",6),e._uU(3,"Drop Your CloudCoins Here"),e.qZA(),e.TgZ(4,"p",7),e.TgZ(5,"span",8),e._UZ(6,"fa-icon",9),e._uU(7," Please deposit only 3200 coins maximum at a time"),e.qZA(),e.qZA(),e.TgZ(8,"div",10),e.TgZ(9,"div",11),e.TgZ(10,"div",12),e.TgZ(11,"div",13),e.TgZ(12,"div",14),e.NdJ("change",function(i){return e.CHM(t),e.oxw().onSelect(i)}),e.TgZ(13,"ngx-dropzone-label"),e.TgZ(14,"div"),e._UZ(15,"img",15),e.TgZ(16,"span",16),e._uU(17,"Drop your CloudCoins here"),e.qZA(),e.qZA(),e.qZA(),e.YNc(18,y,3,4,"ngx-dropzone-image-preview",17),e.qZA(),e.qZA(),e.qZA(),e._UZ(19,"div",18),e.YNc(20,M,4,1,"div",19),e.TgZ(21,"div",12),e.TgZ(22,"div",20),e.TgZ(23,"button",21),e._uU(24,"SUBMIT"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(12),e.Q6J("accept","*"),e.xp6(6),e.Q6J("ngForOf",t.files),e.xp6(2),e.Q6J("ngIf",!t.doRecord)}}function I(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"ng-lottie",25),e.NdJ("animationCreated",function(i){return e.CHM(t),e.oxw().animationCreated(i)}),e.qZA(),e.TgZ(2,"div",26),e._uU(3),e.qZA(),e.TgZ(4,"div",27),e.TgZ(5,"button",28),e.NdJ("click",function(){return e.CHM(t),e.oxw().hideErrorMessage()}),e._uU(6," Back "),e.qZA(),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("options",t.errorOptions),e.xp6(2),e.Oqu(t.errorMessage)}}function q(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",29),e.TgZ(2,"ng-lottie",30),e.NdJ("animationCreated",function(i){return e.CHM(t),e.oxw().animationCreated(i)}),e.qZA(),e.TgZ(3,"span",31),e._uU(4),e.qZA(),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("options",t.options),e.xp6(2),e.Oqu(t.progressMessage)}}function U(o,r){1&o&&e._UZ(0,"img",39)}function N(o,r){1&o&&e._UZ(0,"img",40)}function F(o,r){1&o&&(e.TgZ(0,"span"),e._uU(1,"Deposit Complete"),e.qZA())}function J(o,r){1&o&&(e.TgZ(0,"span"),e._uU(1,"Deposit Failed"),e.qZA())}function R(o,r){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"span"),e._UZ(2,"fa-icon",24),e._uU(3),e.qZA(),e.qZA()),2&o){const t=e.oxw(3);e.xp6(2),e.Q6J("icon",t.faCheck),e.xp6(1),e.hij("\xa0 Coins deposited: ",t.authentic+t.fracked,"")}}function E(o,r){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"span"),e._UZ(2,"fa-icon",24),e._uU(3),e.qZA(),e.qZA()),2&o){const t=e.oxw(3);e.xp6(2),e.Q6J("icon",t.faExclamationTriangle),e.xp6(1),e.hij("\xa0 Coins rejected: ",t.counterfeit,"")}}function O(o,r){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"span"),e._UZ(2,"fa-icon",24),e._uU(3),e.qZA(),e.qZA()),2&o){const t=e.oxw(3);e.xp6(2),e.Q6J("icon",t.faBug),e.xp6(1),e.hij("\xa0 Deposit errors: ",t.error,"")}}function S(o,r){if(1&o&&(e.ynx(0),e.YNc(1,U,1,0,"img",36),e.YNc(2,N,1,0,"img",37),e.YNc(3,F,2,0,"span",2),e.YNc(4,J,2,0,"span",2),e.TgZ(5,"div",38),e.TgZ(6,"span"),e._UZ(7,"fa-icon",24),e._uU(8),e.qZA(),e.YNc(9,R,4,2,"div",2),e.YNc(10,E,4,2,"div",2),e.YNc(11,O,4,2,"div",2),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.depositSuccess),e.xp6(1),e.Q6J("ngIf",t.depositSuccess),e.xp6(1),e.Q6J("ngIf",t.depositSuccess),e.xp6(1),e.Q6J("ngIf",!t.depositSuccess),e.xp6(3),e.Q6J("icon",t.faCoins),e.xp6(1),e.hij(" Coins attempted: ",t.total,""),e.xp6(1),e.Q6J("ngIf",t.authentic+t.fracked>0),e.xp6(1),e.Q6J("ngIf",t.counterfeit>0),e.xp6(1),e.Q6J("ngIf",t.error>0)}}function j(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",29),e._UZ(1,"div",18),e.YNc(2,S,12,9,"ng-container",2),e._UZ(3,"div",32),e.TgZ(4,"div",33),e.TgZ(5,"button",34),e._UZ(6,"img",35),e._uU(7," Check Balance"),e.qZA(),e.TgZ(8,"button",28),e.NdJ("click",function(){return e.CHM(t),e.oxw().showReceipt()}),e._uU(9,"See Details"),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.showResult)}}function Q(o,r){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"p",49),e._uU(2),e.qZA(),e.TgZ(3,"p",49),e._uU(4),e.qZA(),e.TgZ(5,"p",49),e._uU(6),e.qZA(),e._UZ(7,"hr",52),e._UZ(8,"div",18),e.qZA()),2&o){const t=r.$implicit;e.xp6(2),e.hij(" Serial Number: ",t.value.sn,""),e.xp6(2),e.hij(" Pownstring : ",t.value.pownstring,""),e.xp6(2),e.hij(" Result : ",t.value.result,"")}}function P(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",41),e.TgZ(1,"div",42),e.NdJ("click",function(){return e.CHM(t),e.oxw().showReceipt()}),e.qZA(),e.TgZ(2,"div",43),e.TgZ(3,"div",44),e.TgZ(4,"h1"),e._uU(5,"Details:"),e.qZA(),e.TgZ(6,"div",45),e.NdJ("click",function(){return e.CHM(t),e.oxw().showReceipt()}),e._UZ(7,"img",46),e.qZA(),e.qZA(),e.TgZ(8,"div",47),e.TgZ(9,"div",48),e.TgZ(10,"p",49),e._uU(11,"The Pownstring shows each of the 25 RAIDA's responses from 0 to 24 encoded in a single character."),e._UZ(12,"br"),e._uU(13,"p = Pass, f = Fail, u = Untried, n = No response, e = Error"),e.qZA(),e._UZ(14,"div",50),e.YNc(15,Q,9,3,"div",51),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(15),e.Q6J("ngForOf",t.receiptDetails)}}const B=[{path:"",component:(()=>{class o{constructor(t,s,i,n,a){this.auth=t,this.router=s,this.skyvault=i,this.changeDetectorRef=n,this.indc=a,this.faInfoCircle=f.sqG,this.faCoins=f.owJ,this.faCheck=f.LEp,this.faExclamationCircle=f.RLE,this.faExclamationTriangle=f.eHv,this.faBug=f.QLU,this.files=[],this.token=null,this.errorMessage=null,this.options={path:"/assets/animations/cloud_upload.json"},this.errorOptions={path:"/assets/animations/error.json"},this.showLoader=!1,this.showNormal=!0,this.showError=!1,this.complete=!1,this.completeMessage=null,this.progressMessage=null,this.queueLength=0,this.queueIndexStart=0,this.queueIndexEnd=0,this.requestCounter=0,this.responsecounter=0,this.completeCallBack=!1,this.responseArray=[],this.ccCheck=[],this.doRecord=!0,this.showReceiptModal=!1,this.receiptDetails=[],this.showResult=!0,this.counterfeit=0,this.error=0,this.authentic=0,this.total=0,this.fracked=0,this.depositSuccess=!1,this.doRecord=JSON.parse(localStorage.getItem("statements")),this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.progressMessage="Depositing..",this.processing=!1}ngOnInit(){localStorage.setItem("job","0"),this.auth.getLoggedIn()||(this.auth.checkLoginStatus(),this.router.navigate(["/welcome"])),this.watch=this.auth.watch().subscribe(t=>{t||this.router.navigate(["/welcome"])}),this.watchIndicator=this.indc.currentRStatus.subscribe(t=>{0==Object.keys(t).length?(this.options={path:"/assets/animations/cloud_loading.json"},this.showLoading(!0),this.progressMessage="Contacting RAIDA..."):(this.options={path:"/assets/animations/cloud_upload.json"},this.processing||this.showLoading(!1))})}ngOnDestroy(){this.watch&&this.watch.unsubscribe(),this.watchIndicator&&this.watchIndicator.unsubscribe()}onSelect(t){this.files.push(...t.addedFiles),this.auth.getLoggedIn()?(this.token=this.auth.getToken(),this.checkFileDenominations()):(this.auth.checkLoginStatus(),this.router.navigate(["welcome"]))}onRemove(t){this.files.splice(this.files.indexOf(t),1)}checkFileDenominations(){return(0,m.mG)(this,void 0,void 0,function*(){const t=this;let s=0,i=[],n=0;this.showLoading(!0),this.processing=!0,localStorage.setItem("job","1");for(const a of Object.values(this.files)){let p=a.name.split(".").pop();if("png"==p||"PNG"==p){const c=new FileReader;c.readAsDataURL(a),c.onload=function(){return(0,m.mG)(this,void 0,void 0,function*(){const g={template:c.result};let C=yield t.skyvault.extractPng(g);n++;try{let d=C.cloudcoin;for(let u=0;u<d.length;u++){const h=d[u];if(-1!==t.ccCheck.indexOf(h.sn))return s=0,i=[],n=0,t.ccCheck=[],t.files=[],t.showErrorMessage("Duplicate coin with serial number: "+h.sn+" within selected files. Please re-attach coins, and attach a coin only once."),void localStorage.setItem("job","0");t.ccCheck.push(h.sn),i.push(h),s+=t.skyvault.getDenomination(h.sn)}n>=t.files.length&&t.processCoins(s,i)}catch(d){return console.log(d),t.showErrorMessage("Failed to parse CloudCoin"),t.files=[],void localStorage.setItem("job","0")}})},c.onerror=function(g){console.log("Error: ",g),n++,t.showErrorMessage("Unable to parse CloudCoin File")}}else{if("cc"!=p&&"CC"!=p&&"bin"!=p&&"BIN"!=p)return"stack"==p?(t.showErrorMessage("Oops! This is an old coin. Please convert it to our new version from your Cloudcoin Manager."),s=0,i=[],n=0,t.ccCheck=[],t.files=[],void localStorage.setItem("job","0")):(t.showErrorMessage("File not supported!!"),s=0,i=[],n=0,t.ccCheck=[],t.files=[],void localStorage.setItem("job","0"));{const c=new FileReader;c.readAsArrayBuffer(a),c.onload=function(){return(0,m.mG)(this,void 0,void 0,function*(){let g=c.result,C=yield t.skyvault.extractCC(g);n++;try{let d=C.cc;for(let u=0;u<d.length;u++){const h=d[u];if(-1!==t.ccCheck.indexOf(h.sn))return s=0,i=[],n=0,t.ccCheck=[],t.files=[],t.showErrorMessage("Duplicate coin with serial number: "+h.sn+" within selected files. Please re-attach coins, and attach a coin only once."),void localStorage.setItem("job","0");t.ccCheck.push(h.sn),i.push(h),s+=t.skyvault.getDenomination(h.sn)}n>=t.files.length&&t.processCoins(s,i)}catch(d){return console.log(d),t.showErrorMessage("Failed to parse CloudCoin"),t.files=[],void localStorage.setItem("job","0")}})},c.onerror=function(g){console.log("Error: ",g),n++,t.showErrorMessage("Unable to parse CloudCoin File")}}}}})}processCoins(t,s){return(0,m.mG)(this,void 0,void 0,function*(){if(this.completeCallBack=!1,0===t||0===s.length)return this.showErrorMessage("Denomination not found"),this.files=[],void localStorage.setItem("job","0");let i=[];i=s,this.requestCounter=0,this.responsecounter=0,this.responseArray=[],this.ccCheck=[],this.showLoading(!0);const n={to:this.token.sn,memo:"Deposit by #"+this.token.sn,coins:i};this.responseArray[0]={authentic:0,counterfeit:0,error:0,fracked:0,total:i.length,coins:i,errorMessage:""};let a=yield this.skyvault.detect(n.coins);if(a){if(this.responsecounter++,"done"!==a.status)return this.responseArray[0].errorMessage="Failed to Detect Authenticity of  Coins",this.responseArray[0].counterfeit=n.coins.length,void localStorage.setItem("job","0");if(this.progressMessage="Depositing coins. Detecting Authenticity - Do not close your browser or browse away",a.frackedNotes>0||a.errorNotes>0){this.progressMessage="Depositing coins. Fixing Fracked Coins - Do not close your browser or browse away";let p=yield this.skyvault.fixFracked(a.result);p.fixedNotes>0&&(this.progressMessage="Depositing coins. Fixed "+p.fixedNotes+" Fracked Coins - Do not close your browser or browse away ")}this.performDeposit(n)}})}performDeposit(t){return(0,m.mG)(this,void 0,void 0,function*(){let s=yield this.skyvault.deposit(t);if(console.log("SKYVAULT: deposit (apiSend) response",s),s){this.progressMessage="Depositing coins. Do not close your browser or browse away",this.responseArray[0].authentic=s.authenticNotes,this.responseArray[0].fracked=s.frackedNotes,this.responseArray[0].counterfeit=s.counterfeitNotes,this.responseArray[0].error=s.errorNotes,this.responsecounter++;const n=Object.keys(s.result).map(a=>({type:a,value:s.result[a]}));if(this.receiptDetails=n,!this.doRecord){const a=this.auth.getToken(),c={coin:{sn:a.sn,an:a.an}};yield this.skyvault.deleteRecords(c)}this.responsecounter>=this.requestCounter&&!this.completeCallBack&&(this.completeCallBack=!0,this.completedProcessing())}})}completedProcessing(){let t=!1;for(const c of this.responseArray)(c.error>0||c.counterfeit>0)&&(t=!0),this.authentic=0+c.authentic,this.error=0+c.error,this.fracked=0+c.fracked,this.total=0+c.total,this.counterfeit=0+c.counterfeit;this.authentic+this.fracked===0?this.depositSuccess=!1:(this.depositSuccess=!0,this.showResult=!0),this.showCompleteMessage(""),this.completeCallBack=!1,localStorage.setItem("job","0")}showReceipt(){this.showReceiptModal=!this.showReceiptModal}sleep(t){return new Promise(s=>setTimeout(s,t))}animationCreated(t){}showCompleteMessage(t){this.completeMessage=t,this.complete=!0,this.showError=!1,this.showNormal=!1,this.showLoader=!1}showLoading(t){t?(this.showNormal=!1,this.showLoader=!0,this.showError=!1):(this.showNormal=!0,this.showLoader=!1,this.showError=!1)}showErrorMessage(t){this.errorMessage=t,this.showNormal=!1,this.showError=!0,this.showLoader=!1}hideErrorMessage(){this.errorMessage="",this.showNormal=!0,this.showError=!1,this.showLoader=!1}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(A.r),e.Y36(_.F0),e.Y36(D._),e.Y36(e.sBO),e.Y36(k.Q))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-deposit"]],decls:7,vars:5,consts:[[1,"pageWrapper"],[1,"sectionWrapper"],[4,"ngIf"],["class","text-center subInnerHeader",4,"ngIf"],["class","modalContainer",4,"ngIf"],[1,"depositWrap"],[1,"sectionTitle"],[1,"sectionContent",2,"margin-top","-8px"],[1,"alert-send-msg"],["icon","exclamation-circle"],[1,"depositForm"],[1,"row"],[1,"col-md-12"],[1,"dropDebitcardWrapOuter"],["ngx-dropzone","",1,"dropDebitcardWrap",3,"accept","change"],["src","assets/images/debit-card_drop.svg","alt","drop icon",1,"dropIcon"],[1,"dropLabel"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed",4,"ngFor","ngForOf"],[1,"gap10"],["class","col-md-12 disclaimer",4,"ngIf"],[1,"button-wrapper"],[1,"buttonCustome"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed"],[1,"col-md-12","disclaimer"],[3,"icon"],["height","100px",3,"options","animationCreated"],[1,"errorMsg",2,"color","#ffffff","margin-bottom","10px"],[1,"text-center"],[1,"buttonCustome",3,"click"],[1,"text-center","subInnerHeader"],["height","150px",3,"options","animationCreated"],[1,"errorMsg",2,"color","#ffffff"],[1,"gap20"],[1,"btnWrapper"],["routerLink","/balance",1,"buttonCustome"],["src","assets/images/balance-wallet.svg","alt","icon",1,"walletIcon"],["src","assets/images/information-white.svg","alt","information icon","class","resultIcon",4,"ngIf"],["src","assets/images/check-white.svg","alt","information icon","class","resultIcon",4,"ngIf"],[1,"depositResponse"],["src","assets/images/information-white.svg","alt","information icon",1,"resultIcon"],["src","assets/images/check-white.svg","alt","information icon",1,"resultIcon"],[1,"modalContainer"],[1,"modalOverlay",3,"click"],[1,"modalWrap","modalMedium"],[1,"modalHeader"],[1,"modalClose",3,"click"],["src","assets/images/close.svg","alt","icon"],[1,"modalBody","scroll1"],[1,"sectionOne"],[1,"text-white","mb-n1"],[1,"gap30"],[4,"ngFor","ngForOf"],[2,"color","#8581c0"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,b,25,3,"ng-container",2),e.YNc(3,I,7,2,"ng-container",2),e.YNc(4,q,5,2,"ng-container",2),e.YNc(5,j,10,1,"div",3),e.qZA(),e.qZA(),e.YNc(6,P,16,1,"div",4)),2&t&&(e.xp6(2),e.Q6J("ngIf",s.showNormal),e.xp6(1),e.Q6J("ngIf",s.showError),e.xp6(1),e.Q6J("ngIf",s.showLoader),e.xp6(1),e.Q6J("ngIf",s.complete),e.xp6(1),e.Q6J("ngIf",s.showReceiptModal))},directives:[v.O5,w.BN,x._f,x.Jj,v.sg,x.sv,T.e$,_.rH],styles:[".depositWrap[_ngcontent-%COMP%]{width:100%;height:initial;max-width:600px;margin:0 auto}.depositWrap[_ngcontent-%COMP%]   .depositForm[_ngcontent-%COMP%]{margin-top:40px}@media (max-width: 576px){.depositWrap[_ngcontent-%COMP%]   .depositForm[_ngcontent-%COMP%]{margin-top:20px}}.depositWrap[_ngcontent-%COMP%]   .depositForm[_ngcontent-%COMP%]   .button-wrapper[_ngcontent-%COMP%]{margin:30px auto 0;text-align:center;width:100%}.depositWrap[_ngcontent-%COMP%]   .depositForm[_ngcontent-%COMP%]   .dropDebitcardWrapOuter[_ngcontent-%COMP%]{width:100%}.scroll1[_ngcontent-%COMP%]{overflow:auto;max-height:400px}"]}),o})()}];let L=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[_.Bz.forChild(B)],_.Bz]}),o})(),Y=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[v.ez,L,x.bB,T.CT,w.uH]]}),o})()}}]);